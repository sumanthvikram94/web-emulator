"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.EventLoopSampler = void 0;
const perf_hooks_1 = require("perf_hooks");
class EventLoopSampler {
    constructor() {
        this.sampleData = undefined;
        this.sampleFunc = () => {
            if (!this.isAvailable()) {
                return;
            }
            if (this._lastElu === undefined) {
                this._lastElu = perf_hooks_1.performance.eventLoopUtilization();
                this.sampleData = this._lastElu;
            }
            else {
                const elu = perf_hooks_1.performance.eventLoopUtilization(this._lastElu);
                this.sampleData = elu;
                this._lastElu = perf_hooks_1.performance.eventLoopUtilization();
            }
        };
    }
    onSample(callback) {
        callback(this.sampleData);
    }
    isAvailable() {
        return perf_hooks_1.performance.eventLoopUtilization !== undefined;
    }
}
exports.EventLoopSampler = EventLoopSampler;
