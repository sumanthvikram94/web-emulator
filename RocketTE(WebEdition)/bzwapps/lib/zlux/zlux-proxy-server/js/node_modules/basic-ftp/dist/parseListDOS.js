"use strict";
//import { FileInfo, FileType } from "./FileInfo"
Object.defineProperty(exports, "__esModule", { value: true });
exports.transformList = exports.parseLine = exports.testLine = void 0;
/**
 * This parser is based on the FTP client library source code in Apache Commons Net provided
 * under the Apache 2.0 license. It has been simplified and rewritten to better fit the Javascript language.
 *
 * https://github.com/apache/commons-net/blob/master/src/main/java/org/apache/commons/net/ftp/parser/NTFTPEntryParser.java
 */
const RE_LINE = new RegExp("(\\S+)\\s+(\\S+)\\s+" // MM-dd-yy whitespace hh:mma|kk:mm swallow trailing spaces
    + "(?:(<DIR>)|([0-9]+))\\s+" // <DIR> or ddddd swallow trailing spaces
    + "(\\S.*)" // First non-space followed by rest of line (name)
);
/**
 * Returns true if a given line might be a DOS-style listing.
 *
 * - Example: `12-05-96  05:03PM       <DIR>          myDir`
 */
function testLine(line, ftp) {
    ftp.log("testline DOS");
    return /^\d{2}/.test(line) && RE_LINE.test(line);
}
exports.testLine = testLine;
/**
 * Parse a single line of a DOS-style directory listing.
 */
function parseLine(line, ftp) {
    const groups = line.match(RE_LINE);
    ftp.log(groups);
    if (groups === null) {
        return undefined;
    }
    let obj = {};
    ftp.log(groups);
    obj.Name = groups[5];
    if (groups[3] === "<DIR>") {
        obj.type = "folder";
        obj.Size = 0;
    }
    else {
        obj.type = "file";
        obj.Size = parseInt(groups[4], 10);
    }
    obj.Date = groups[1] + " " + groups[2];
    obj.Permissions = "Unknown";
    obj.Owner = "";
    obj.Group = "";
    return obj;
}
exports.parseLine = parseLine;
function transformList(files) {
    return files;
}
exports.transformList = transformList;
