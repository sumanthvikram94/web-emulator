"use strict";
//import { FileInfo, FileType } from "./FileInfo"
Object.defineProperty(exports, "__esModule", { value: true });
exports.transformList = exports.parseLine = exports.testLine = void 0;
//const JA_MONTH = "\u6708"
//const JA_DAY   = "\u65e5"
//const JA_YEAR  = "\u5e74"
const RE_LINE = new RegExp(
/*
//Also supports unix mode listings...

USERS: [HOLMES]
COPY.COM;4     2     1-APR-2017 08:49 [HOLMES] (RWD,RWD,R,R)
LOGIN.COM;1    5     1-APR-2017 01:25 [HOLMES] (RWD,RWD,R,R)

Owner and Permissions seems to be optional
*/
"(\\S+)"
    + "\\s+"
    + "(\\d+)"
    + "\\s+"
    + "(\\d{1,2}-\\S{3}-\\d{1,4})"
    + "\\s+"
    + "(\\d{1,2}:\\d{1,2})"
    + "(?:\\s(\\S+))?"
    + "(?:\\s(\\S+))?");
const RE_LINE2 = new RegExp(
//First line, ignore it
"USERS:"
    + "\\s+"
    + "\\[\\S+]");
/**
 * Returns true if a given line might be a MVS-style listing.
 *
  */
function testLine(line, ftp) {
    ftp.log("testLine: " + line);
    if (RE_LINE2.test(line))
        return true;
    return RE_LINE.test(line);
}
exports.testLine = testLine;
/**
 * Parse a single line of a MVS-style directory listing.
 */
function parseLine(line, ftp) {
    ftp.log("parseLine: " + line);
    let groups = line.match(RE_LINE);
    if (groups === null) {
        return undefined;
    }
    ftp.log(groups);
    ftp.log("count: " + groups.length);
    let obj = {};
    if (typeof groups[5] == 'undefined')
        groups[5] = "Not Supplied";
    if (typeof groups[6] == 'undefined')
        groups[6] = "Not Supplied";
    let Name = groups[1];
    if (Name.indexOf(".DIR") != -1) {
        Name = Name.substring(0, Name.indexOf(".DIR"));
        obj.type = "folder";
    }
    else {
        obj.type = "file";
    }
    obj.Name = Name;
    obj.Blocks = groups[2];
    obj.Date = groups[3] + " " + groups[4];
    obj.Owner = groups[5];
    obj.Permissions = groups[6];
    return obj;
}
exports.parseLine = parseLine;
function transformList(files) {
    return files;
}
exports.transformList = transformList;
